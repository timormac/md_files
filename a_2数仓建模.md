



#### 同步规则

每日全量（分区重复）：小表每日一份，保存历史状态

每日全量（不分区）：数据量大的业务表

每日增量（分区）：

数据量大的业务表，业务同步的时候使用新增导入，这样数据小，到入快。

对于状态发生变化的数据，找出变化时间是今天，然后关联替换到hdfs上的表，不过要洗数据。







#### 命名规则

dwd-主题域-数据库名-表名-ds(ms)

ds和ms 表示是否为分区表，如果为分区表，分区字段是什么，分区间隔为多少



#### 数据划分

维度表是什么，由平台提供的数据

​		用户方面：用户表，会员等级表，客户表

​		商品方面：商品表，类型表，商家表，合同表，库存



事实表由用户行为产生

交易方面：订单，衍生出的：支付相关表，退款相关，核销相关

反馈相关：评价，ugc等







#### ODS

数据不动，只保持增量或者全量导入的区别。

#### DIM

商品表里会放很多主键，通过表再找表的，都会去把主键放进去，确保想要的数据能一次关联拿到

比如合同编号，并冗余经常用的商品数据。

冗余主键，签约员工，合同编号，所属的多级分类，签约客户id

处理：对商品做数据清洗，表小，要没日全量，保持历史状态。

比如商品库存表，用每日全量，能获取库存历史状态，商品负责人，维护人。



用户账户余额表，商品库存表，这种都要每日全量，不如某一天产品要这一个月内，每天所有账户的余额，

或者某些商品这一周内每天的库存，只能通过现有的库存通过加减每天的记录来逆推。



包括的表：商品信息，合同，员工，商家客户信息表



#### DWD（主题域）

各种主键，通过表找表的主键都拿到。保证相关表能关联一次拿到

比如券，关联卡，再关联订单表这。

冗余字段，订单流水id，优惠券表id

还有一些自己生成的字段，比如订单表里加入，最后使用日期，是否完结使用（因为有多次卡或买多分），

来计算用户核销周期。核销了才算彻底的入账。



处理：对数据做数据清洗，缺失字段补全，空字段补全之类的，冗余常用字段，

用户地区，会员等级，商品类型 ，支付渠道，下单渠道，经常用到的字段。



主题域的作用，通过指标字段，能知道用到哪些主题域的表，不用从全表中去筛选。



（已解决看下方）

不过当时从mysql到入的时候命名就带trade,product等字段，为什么还要主题域名。



主题域和表命不冲突，因为有时候数据库的库名太分散

比如hotel库，passcard库，在数据域里面都是商品域的，不够在mysl里是库命是分开的



方入的表：订单表，发券，核销，商家结算，退款

附属表有红包记录表，支付流水





#### DWS

按用户当日汇总

商品当日汇总

流量区域当日汇总

具体字段需要看业务需求，比如某个大品类售卖多少，某种售卖方式卖了多少

#### DWT

按用户汇总，统计用户自注册依赖数据，有这个表对一些总的统计数据，会很容易获得。

用户下单次数，支付次数，使用优惠券次数，渠道次数



按商品汇总

某商品被下单次数，被购买次数，推广渠道各自售卖数量



指标推广渠道收益占比



看具体公司需求，有指标需要用的相关的多做这一层。

比如要近期最近1年内上线，半年内没上线的人。